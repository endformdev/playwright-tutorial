---
title: Generate tests with Playwright MCP
description: Use the Playwright MCP with your AI to generate tests for your application.
sidebar:
  order: 3
---

import { Aside } from '@astrojs/starlight/components';

In this guide, we will use the Playwright MCP to generate tests for your application.

<Aside>
To start from this step, checkout the [`stage-1-setup` branch](https://github.com/endformdev/playwright-tutorial/tree/stage-1-setup) of the [tutorial repository](https://github.com/endformdev/playwright-tutorial).
For more information about getting started with the tutorial repository, go [here](/docs/tutorial/from-cowboy-to-confidence#getting-started-with-the-tutorial-repository).
</Aside>

## Setting up the Playwright MCP Server

In this part of the tutorial, we will be using the [Playwright MCP server](https://github.com/microsoft/playwright-mcp).

We will use Cursor for the purposes of this tutorial, but you could use any IDE or CLI tool that supports MCP in its place.

Be sure to check out the installation instructions in the [Playwright MCP repository](https://github.com/microsoft/playwright-mcp) to correctly set up the Playwright MCP server before continuing.

For example for Cursor, your `mcp.json` file could look like this:

```json
{
  "mcpServers": {
    "playwright": {
      "command": "npx",
      "args": [
        "@playwright/mcp@latest"
      ]
    }
  }
}
```

## Authenticating with the Playwright MCP Server

At the time of writing, the Playwright MCP server doesn't have support for the projects or storage states that we set up in our Playwright config in the previous step. 

You can achieve something similar by using the following flags to the MCP server:

```
--isolated                   keep the browser profile in memory, do not save it to disk.
--storage-state <path>       path to the storage state file for isolated sessions.
```

Our mcp command with these arguments could look like this:

```
npx @playwright/mcp@latest --isolated --storage-state .auth/shared-api-user.json
```

It's just that at the moment, our projects are configured to create and delete users during the course of a suite run, so that user won't exist!

Let's add a script to help us create and remove users for the MCP server when we need them.

<Tabs>
<TabItem label="mcp-user.ts (Hint)">
```ts
// import existing user creation and deletion functions

const scriptArg = process.argv[2];

if (scriptArg !== "create" && scriptArg !== "delete") {
	console.error(
		`Error: Invalid argument "${scriptArg}". Expected "create" or "delete".`,
	);
	process.exit(1);
}

// create or delete user based on script arg
```
</TabItem>
<TabItem label="mcp-user.ts (Completed)">
```ts
import { createUser, deleteUser } from "./setup-utils";

const scriptArg = process.argv[2];

if (scriptArg !== "create" && scriptArg !== "delete") {
	console.error(
		`Error: Invalid argument "${scriptArg}". Expected "create" or "delete".`,
	);
	process.exit(1);
}

const baseURL =
	process.env.BASE_URL || "https://endform-playwright-tutorial.vercel.app";

if (scriptArg === "create") {
	await createUser(baseURL, "mcp");
} else if (scriptArg === "delete") {
	await deleteUser(baseURL, "mcp");
}

```
</TabItem>
</Tabs>

Now we can make an mcp user by running:

```bash
bun run mcp-user create
```

And delete it by running:

```bash
bun run mcp-user delete
```

Don't forget to update our MCP server configuration for our new user.

```json
{
  "mcpServers": {
    "playwright": {
      "command": "npx",
      "args": [
        "@playwright/mcp@latest",
        "--isolated",
        "--storage-state",
        ".auth/shared-mcp-user.json"
      ]
    }
  }
}
```